# Пишем первые тесты с помощью Page Object

## Базовая страница для проекта: BasePage

Теперь мы проведём рефакторинг теста в файле `test_main_page.py` который мы представили
на этапе настройки среды, используя шаблон Page Object.
Наше внимание будет сосредоточено на главной странице нашего приложения, и для этого мы дадим
классу говорящее имя, например «MainPage».

Примечание. Мы создадим базовую реализацию шаблона Page Object с нуля. В следующих уроках мы
рассмотрим существующие фреймворки и то, как они могут упростить наш рабочий процесс. Сейчас крайне важно
сосредоточиться на понимании основных принципов этого шаблона.

1. Создайте в своем проекте директорию pages, там мы будем хранить все наши Page Object.
2. В папке создайте два файла: base_page.py и main_page.py.

Для начала мы создадим базовый класс страницы, который будет служить основой для всех остальных классов. Эта базовая
страница будет содержать служебные методы для взаимодействия с драйвером.

3. В файле base_page.py создайте класс с названием BasePage.
4. Далее мы добавим методы в наш класс. Прежде всего, давайте включим конструктор, который является методом, вызываемым
   при создании объекта. Конструктор определяется с помощью ключевого слова \_\_init__. Мы передадим экземпляр драйвера
   и URL-адрес в качестве параметров конструктору. Внутри конструктора мы будем хранить эти данные как атрибуты нашего
   класса.

```python
def __init__(self, browser, url):
    self.browser = browser
    self.url = url

```

5. Реализуем метод открытия страницы, путём вызовы метода `get()`:

```python
def open(self):
    pass

```

Вам необходимо самостоятельно реализовать этот метод. В результате в файле `base_page.py` у вас должно быть следующее:

```python
class BasePage:
    def __init__(self, browser, url):
        self.browser = browser
        self.url = url

    def open(self):
# ваша реализация

```

## Page Object для главной страницы сайта

Теперь приступим к реализации Page Object, который будет связан с главной страницей интернет-магазина.

1. Откройте файл `main_page.py`
2. В нем нужно сделать импорт базового класса BasePage:

`from .base_page import BasePage`

3. В нём создайте класс MainPage. Наследуйте его от класса BasePage, чтобы он получил все его методы и атрибуты:

`class MainPage(BasePage):`

4. Перенесите метод открытия страницы логина в класс MainPage:

```python
def go_to_login_page(browser):
    login_link = browser.find_element(By.CSS_SELECTOR, '#login_link')
    login_link.click()

```

Поскольку экземпляр браузера мы создаём и передаём на этапе создания Page Object, то нам больше не нужно передавать его
в качестве аргумента. Вместо этого необходимо использовать аргумент `self`, чтобы иметь доступ к методам и атрибутам
класса.

Так как браузер - это аргумент класса BasePage, то обращаться к нему нужно
через `self`:

```python
self.browser.find_element(By.CSS_SELECTOR, '#login_link')

```

В итоге, ваш файл `main_page.py` должен выглядеть следующим образом:

```python
from .base_page import BasePage
from selenium.webdriver.common.by import By


class MainPage(BasePage):
    def go_to_login_page(self):
        login_link = self.browser.find_element(By.CSS_SELECTOR, '#login_link')
        login_link.click()

```

## Первый тест на основе Page Object

Обратите внимание, что в директории `pages` должны находиться только Page Objects.

Давайте теперь перепишем тест с помощью Page Object:

1. Создайте файл для тестов главной страницы, поместите его на уровне с `conftest.py` и `requirements.txt`, тоесть в
   корневом каталоге вашего проекта. Назовём его `test_main_page.py`.
2. Откройте файл `test_main_page.py`.
3. Импортируйте класс главной страницы из директории `pages`:

```python
from .pages.main_page import MainPage

```

4. Теперь отрефакторим сам тест:

```python
from .pages.main_page import MainPage


def test_guest_can_go_to_login_page(browser):
    link = 'http://selenium1py.pythonanywhere.com/'
    page = MainPage(browser, link)  # инициализация Page Object
    page.open()  # открыть страниу
    page.go_to_login_page()  # перейти на страницу логина

```

5. Запустите тест, чтобы убедиться, что он работает. Можете использовать любую команду для запуска,
   например `pytest -v --tb=line --language=en test_main_page.py`.

6. Не забывайте коммитить вносимые изменения (обязательно с осмысленными сообщениями о том, что изменилось. Рекомендую
   использовать только английский язык как для сообщений в коммитах, так и в пул реквестах, описаниях, комментариях и
   докстрингах.)

Теперь наш тест почти что полность написан согласно стилю Page Object. Почему почти - узнаете чуть позже.

